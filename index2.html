<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- link -->
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <script src="./js/jquery-3.6.1.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>

    <!-- Style -->
    <style>
        li {
            width: 150px;
        }

        [class*="col-"] {
            padding-left: 0;
            padding-right: 0;
            box-sizing: border-box;
        }
    </style>

    <!-- script -->

    <script>
        $(document).ready(() => {

            $('#register').click(() => {
                $('#registerModal').modal('show')
            })

            // regex
            const checkId = /^(K16-){1}([0-9]){9}$/; // b keytest mssv 
            const checkName = /(^[A-Z]{1})([a-z]+)(\s[A-Z]{1}([a-z])*)*$/ // c keytest name
            const checkClass = /^[A-Z0-9]{11}$/; // d keytest Class
            // const checkTelPhone = /^(0){1}[0-9]{9}$/ // keytest telNumber 
            const checkTelPhone = /^(0){1}[0-9]{9}$/ // keytest telNumber 
            // const checkEmail = /(^(\w){5}@(iuh.edu.vn))$/ /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/
            const checkEmail = /(^(\w)*@(iuh.edu.vn))$/
            const checkDay = /^[0-9]{4}-[0-9]{1,2}-[0-9]{1,2}$/

            //variable
            const render = $('#render');
            const idStudents = $('#idStudents')
            const idStudentsSpan = $('#idStudentsSpan')
            const idStudentsLable = $('#idStudentsLable')
            const name = $('#name')
            const nameSpan = $('#nameSpan')
            const nameLabel = $('#nameLabel')
            const telNumber = $('#telNumber')
            const telNumberSpan = $('#telNumberSpan')
            const telNumberLabel = $('#telNumberLabel')
            const Class = $('#class')
            const CLassSpan = $('#classSpan')
            const ClassLable = $('#classLable')
            const day_join = $('#day_join')
            const day_joinSpan = $('#day_joinSpan')
            const day_joinLabel = $('#day_joinLabel')
            const email = $('#email')
            const emailspan = $('#emailspan')
            const emaillabel = $('#emaillabel')
            const text_success = 'text-success'
            const text_danger = 'text-danger'
            const border_success = 'border-success'
            const border_danger = 'border-danger'

            // Validate
            const Validation = [
                {
                    id: 1,
                    name: idStudents,
                    mes: 'Bắt buộc nhập!',
                    mes_1: 'Vui lòng nhập đúng mã!',
                    span: idStudentsSpan,
                    label: idStudentsLable,
                    check: checkId,
                    already: false,
                },
                {
                    id: 2,
                    name: name,
                    mes: 'Bắt buộc nhập!',
                    mes_1: 'Vui lòng nhập đúng tên! Yêu cầu chữ cái đầu viết hoa!',
                    span: nameSpan,
                    label: nameLabel,
                    check: checkName,
                    already: false,
                },

                {
                    id: 3,
                    name: Class,
                    mes: 'Bắt buộc nhập!',
                    mes_1: 'Vui lòng viết in hoa!',
                    span: CLassSpan,
                    label: ClassLable,
                    check: checkClass,
                    already: false,
                },
                {
                    id: 4,
                    name: telNumber,
                    mes: 'Bắt buộc nhập!',
                    mes_1: 'Số điện thoại phải bắt đầu bằng số 0!',
                    span: telNumberSpan,
                    label: telNumberLabel,
                    check: checkTelPhone,
                    already: false,
                },
                {
                    id: 5,
                    name: email,
                    mes: 'Bắt buộc nhập!',
                    mes_1: 'Vui lòng nhập đúng email của bạn!',
                    span: emailspan,
                    label: emaillabel,
                    check: checkEmail,
                    already: false,
                },
                {
                    id: 6,
                    name: day_join,
                    mes: 'Bắt buộc nhập!',
                    mes_1:'Ngày tham gia bắt đầu từ ngày 01/11/2022 tới 01/12/2022',
                    span: day_joinSpan,
                    label: day_joinLabel,
                    check: checkDay,
                    already: false,

                }
            ]


            const handelNotValue = (item, elem) => {
                item.label.remove(text_success)
                item.label.addClass(text_danger)
                elem.removeClass(border_success)
                elem.addClass(border_danger)
                item.span.text(item.mes)
                item.already = false
            }

            const handelErrorValue = (item, elem) => {
                elem.removeClass(border_success)
                elem.addClass(border_danger)
                item.label.remove(text_success, text_danger)
                item.label.addClass(text_danger)
                item.span.text(item.mes_1)
                item.already = false
            }

            const handelSuccessValue = (item, elem) => {
                item.label.removeClass(text_danger)
                item.label.addClass(text_success)
                elem.removeClass(border_danger)
                elem.addClass(border_success)
                item.span.text("")
                item.already = true
            }
            const handelRemoveClass = (item, elem) => {
                item.label.removeClass(text_danger)
                item.label.removeClass(text_success)
                elem.removeClass(border_danger)
                elem.removeClass(border_success)
                item.span.text("*")
            }


            Validation.map((item) => {
                let elem = item.name

                elem.blur(() => {
                    if (elem.val() === '') {
                        handelNotValue(item, elem);
                    } else if (item.check) {
                        if (item.check.test(elem.val())) {
                            handelSuccessValue(item, elem);
                        } else {
                            handelErrorValue(item, elem);
                        }
                    }
                })

            })
            const resultImformations = []
            let stt = 0

            const addIf = (stt,[a, b, c, d, e]) => {

                const people = {
                    stt: stt,
                    mssv: a,
                    name: b,
                    class: c,
                    num: d,
                    email: e,
                }
                render.append(`<tr>
                          <th>${people.stt}</th>  
                          <th>${people.mssv}</th>  
                          <th>${people.name}</th>  
                          <th>${people.class}</th>  
                          <th>${people.num}</th>  
                          <th>${people.email}</th>  
                        </tr>`)
            }

            $('#submit').click(() => {
                let checked = true;
                Validation.map(item => {
                    if(!item.already)
                    {
                        handelNotValue(item,item.name)
                        checked = false
                    }
                })  
                if(checked) {
                    const result = []
                    Validation.map(item => {
                        result.push(item.name.val())
                        item.name.val('')
                        handelRemoveClass(item, item.name)
                        $('#registerModal').modal('hide')
                    })
                    addIf(stt,result)
                    stt++;
                }

            })


        })
    </script>


</head>

<body>
    <div class="container border">
        <div class="row">
            <img src="./banner.PNG" alt="DHCNTPHCM" width="100%">
        </div>
        <div class="row">
            <div class="col-12 col-sm-12">
                <nav class="navbar-collapse navbar-expand">
                    <ul class="navbar-nav navbar-dark">
                        <li class="nav-item ">
                            <a href="#" class="nav-link">Dang nhap</a>
                        </li>
                        <li class="nav-item" id="register">
                            <a href="#" class="nav-link">Dang ki</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-sm-12" style="display: flex;justify-content: center;">
                <h1 class="text-center" style="width: 90%;">DANH SÁCH THAM GIA ĐỘI ROBOCO KHOA CNTT</h1>
            </div>
        </div>
        <div class="row">
            <table class="table-bordered table-light table-hover table-primary table table-striped" id="render">
                <tr>
                    <th>STT</th>
                    <th>MSSV</th>
                    <th>Ho ten</th>
                    <th>Lop</th>
                    <th>Dien thoai</th>
                    <th>Email</th>
                </tr>
            </table>
        </div>
        <div class="row">
            <div class="col-12 col-sm-12" style="display: flex;justify-content: center;">
                <span>
                    <p>SVTH: Nguyễn Đình Đức</p>
                </span>
                <span>
                    <p>. MSSV: 21132371</p>
                </span>
                <span>
                    <p>. Lop:DHCNTT17B</p>
                </span>
            </div>
        </div>
        <div class="row">
            <div class="modal " id="registerModal" aria-hidden="true" style="display: none;">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4>THONG TIN CA NHAN</h4>
                            <button type="button" class="close border-1 bg-transparent" id="close-modal-btn"
                                data-dismiss="modal">X</button>
                        </div>
                        <div class="modal-body">
                            <form class="form-control" id="dangkiform">
                                <div class="row mb-3 container">
                                    <div class="col-6 col-sm-3">
                                        <label for="" id="idStudentsLable">Mã thành viên:</label>
                                    </div>
                                    <div class="col-6 col-sm-9">
                                        <input type="text" class="form-control" placeholder="K16-xxxxxxxxxxx"
                                            id="idStudents">
                                    </div>
                                    <span class="text-danger" id="idStudentsSpan">*</span>
                                </div>
                                <div class="row mb-3 container ">
                                    <div class="col-6 col-sm-3">
                                        <label id="nameLabel">Họ tên:</label>
                                    </div>
                                    <div class="col-6 col-sm-9">
                                        <input type="text" class="form-control " id="name"
                                            placeholder="Họ tên: Nguyễn Văn A" name="name">
                                    </div>
                                    <span class="text-danger" id="nameSpan">*</span>
                                </div>
                                <div class="row mb-3 container">
                                    <div class="col-6 col-sm-3">
                                        <label id="classLable" for="">Lớp: </label>
                                    </div>
                                    <div class="col-6 col-sm-9">
                                        <input type="text" class="form-control" placeholder="Lớp:DHCNTT17B" id="class">
                                    </div>
                                    <span class="text-danger" id="classSpan">*</span>
                                </div>
                                <div class="row mb-3 container">
                                    <div class="col-6 col-sm-3">
                                        <label id="day_joinLabel" for="">Ngày tham gia:</label>
                                    </div>
                                    <div class="col-6 col-sm-9">
                                        <input type="date" class="form-control" id="day_join">
                                    </div>
                                    <span class="text-danger" id="day_joinSpan">*</span>
                                </div>
                                <div class="row mb-3 container">
                                    <div class="col-6 col-sm-3">
                                        <label for="" id="telNumberLabel">Số điện thoại: </label>
                                    </div>
                                    <div class="col-6 col-sm-9">
                                        <input type="text" class="form-control" placeholder="telNumber:0xxx-xxx-xxx"
                                            id="telNumber">
                                    </div>
                                    <span class="text-danger" id="telNumberSpan">*</span>
                                </div>
                                <div class="row mb-3 container">
                                    <div class="col-6 col-sm-3">
                                        <label id="emaillabel" for="">Email</label>
                                    </div>
                                    <div class="col-6 col-sm-9">
                                        <input type="text" class="form-control" placeholder="Email:xxxxx@iuh.deu.vn"
                                            id="email">
                                    </div>
                                    <span class="text-danger" id="emailspan">*</span>
                                </div>

                                <div class="row mb-3 ">
                                    <div class="col">
                                        <input type="button" class="col-12 col-sm-12 bg-success border-0" value="Lưu"
                                            id="submit">
                                    </div>

                                </div>
                            </form>
                        </div>
                        <div class="modal-footer"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>
